# 时间服务迁移测试验证清单

## 🎯 迁移完成状态

### ✅ 已完成迁移的文件
1. **volunteerAPI.ts** - 志愿者API服务
2. **VolunteerCheckInScreen.tsx** - 志愿者签到屏幕
3. **VolunteerCheckOutScreen.tsx** - 志愿者签退屏幕
4. **VolunteerSchoolDetailScreen.tsx** - 学校志愿者详情屏幕
5. **VolunteerHistoryBottomSheet.tsx** - 历史记录底部弹窗
6. **VolunteerHomeScreen.tsx** - 志愿者主页
7. **VolunteerQuickActionModal.tsx** - 快速操作模态框
8. **ActivityDetailScreen.tsx** - 活动详情屏幕
9. **userAdapter.ts** - 用户数据适配器

### ⚠️ 已标记为废弃但保留的文件
- **timeHelper.ts** - 所有函数已标记 `@deprecated`
- **volunteerTimeFormatter.ts** - 所有函数已标记 `@deprecated`

## 🔍 需要手动验证的功能点

### 1. 志愿者签到功能
**测试位置**: `VolunteerCheckInScreen.tsx`

#### 测试步骤：
- [ ] 打开志愿者管理页面
- [ ] 点击签到按钮
- [ ] 验证签到时间显示正确（应显示本地时间）
- [ ] 检查签到成功后的时间记录

#### 验证点：
- [ ] 签到时间是否正确转换为北京时间发送到后端
- [ ] 前端显示的时间是否为用户本地时间
- [ ] 时间格式是否为 `HH:mm` 格式

### 2. 志愿者签退功能
**测试位置**: `VolunteerCheckOutScreen.tsx`

#### 测试步骤：
- [ ] 完成签到后，点击签退按钮
- [ ] 查看工作时长计算是否正确
- [ ] 输入工作描述并提交

#### 验证点：
- [ ] 签到时间显示是否正确（格式：HH:mm）
- [ ] 签退时间显示是否正确（当前本地时间）
- [ ] 工作时长计算是否准确（X小时X分钟）
- [ ] 超时警告是否正常显示（>12小时）

### 3. 历史记录查看
**测试位置**: `VolunteerHistoryBottomSheet.tsx`

#### 测试步骤：
- [ ] 打开志愿者历史记录
- [ ] 选择不同的时间范围（1天、3天、7天、30天）
- [ ] 查看历史记录的时间显示

#### 验证点：
- [ ] 签到/签退时间显示格式（今日 HH:mm 或 MM/DD HH:mm）
- [ ] 工作时长计算是否正确
- [ ] 超时记录是否有警告标识
- [ ] 时间异常的记录是否正确标记

### 4. 学校志愿者管理
**测试位置**: `VolunteerSchoolDetailScreen.tsx`

#### 测试步骤：
- [ ] 进入学校志愿者管理页面
- [ ] 查看志愿者列表的签到状态
- [ ] 查看最后签到/签退时间

#### 验证点：
- [ ] 志愿者状态时间显示是否正确
- [ ] 时间解析是否处理了各种格式
- [ ] 时间异常检测是否正常工作

### 5. 活动管理
**测试位置**: `ActivityDetailScreen.tsx`

#### 测试步骤：
- [ ] 查看活动详情
- [ ] 检查活动时间显示
- [ ] 验证活动是否过期的判断

#### 验证点：
- [ ] 活动开始/结束时间显示格式
- [ ] 活动过期判断逻辑是否正确
- [ ] 时间格式化是否支持12小时制（AM/PM）

### 6. 快速操作模态框
**测试位置**: `VolunteerQuickActionModal.tsx`

#### 测试步骤：
- [ ] 通过快速操作进行签到/签退
- [ ] 查看工作时长计算

#### 验证点：
- [ ] 快速签退时的时长计算
- [ ] 时间格式化显示是否正确

## 🌍 时区测试场景

### 测试环境设置
建议在以下时区进行测试：
1. **北京时间 (UTC+8)** - 默认后端时区
2. **美东时间 (UTC-5/UTC-4)** - 常见用户时区
3. **英国时间 (UTC+0/UTC+1)** - 欧洲时区
4. **澳洲时间 (UTC+10/UTC+11)** - 南半球时区

### 测试要点
- [ ] 跨日期的时间显示（如北京时间23:00，美东时间11:00）
- [ ] 夏令时切换期间的时间显示
- [ ] 时长计算的准确性（不受时区影响）

## 📝 API兼容性验证

### 后端API格式要求
- **发送格式**: `YYYY-MM-DD HH:mm:ss`（北京时间）
- **接收格式**: `YYYY-MM-DD HH:mm:ss`（北京时间）

### 验证点
- [ ] 签到API调用 - `/app/hour/signRecord`
- [ ] 签退API调用 - `/app/hour/signRecord`
- [ ] 历史记录API - `/app/hour/records`
- [ ] 用户信息API - `/app/user/info`

## ⚠️ 边界情况测试

1. **空值处理**
   - [ ] 未签到时显示 `--:--`
   - [ ] 未签退时工作时长显示正确

2. **异常时间**
   - [ ] 负时长（结束时间早于开始时间）
   - [ ] 超长时间（>30天）
   - [ ] 未来时间

3. **格式兼容**
   - [ ] ISO格式时间字符串
   - [ ] 带时区的时间字符串
   - [ ] Unix时间戳

## 🔄 回归测试

确保以下功能未受影响：
- [ ] 用户登录/登出
- [ ] 活动报名
- [ ] 个人信息编辑
- [ ] 权限管理
- [ ] 国际化切换（中英文）

## 📊 性能验证

- [ ] 页面加载速度未明显降低
- [ ] 列表滚动流畅度保持
- [ ] 时间格式化不造成UI卡顿

## ✅ 测试完成确认

完成所有测试后，请确认：
- [ ] 所有功能点已测试通过
- [ ] 无新增bug或异常
- [ ] 用户体验保持一致
- [ ] 性能未受明显影响

---

**测试人员**：_______________

**测试日期**：_______________

**测试结果**：□ 通过  □ 不通过

**备注**：
_________________________________________________
_________________________________________________
_________________________________________________