<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PomeloX è¡¨å•è¾“å…¥è°ƒè¯•å·¥å…·</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .debug-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 16px;
            padding: 32px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            max-width: 800px;
            margin: 0 auto;
        }
        
        h1 {
            color: #2d3748;
            margin-bottom: 8px;
            font-size: 28px;
            font-weight: 700;
        }
        
        .subtitle {
            color: #718096;
            margin-bottom: 32px;
            font-size: 16px;
        }
        
        .debug-section {
            background: white;
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 24px;
            border: 1px solid #e2e8f0;
        }
        
        .debug-section h2 {
            color: #2d3748;
            font-size: 20px;
            margin-bottom: 16px;
            border-bottom: 2px solid #667eea;
            padding-bottom: 8px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #4a5568;
        }
        
        input, textarea {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.2s ease;
            box-sizing: border-box;
        }
        
        input:focus, textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        input:hover {
            border-color: #cbd5e0;
        }
        
        .test-input {
            background: #f7fafc;
        }
        
        .rn-web-input {
            background: #fff5f5;
            border-color: #fc8181;
        }
        
        .debug-log {
            background: #1a202c;
            color: #e2e8f0;
            padding: 16px;
            border-radius: 8px;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 14px;
            max-height: 300px;
            overflow-y: auto;
            white-space: pre-wrap;
            margin-top: 16px;
        }
        
        .button {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            margin-right: 12px;
            margin-bottom: 12px;
        }
        
        .button:hover {
            background: #5a67d8;
            transform: translateY(-1px);
        }
        
        .button.danger {
            background: #e53e3e;
        }
        
        .button.danger:hover {
            background: #c53030;
        }
        
        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .status-success { background: #38a169; }
        .status-error { background: #e53e3e; }
        .status-warning { background: #d69e2e; }
        
        .hidden {
            display: none;
        }
        
        .test-results {
            margin-top: 16px;
            padding: 16px;
            background: #f7fafc;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }
    </style>
</head>
<body>
    <div class="debug-container">
        <h1>ğŸ”§ PomeloX è¡¨å•è¾“å…¥è°ƒè¯•å·¥å…·</h1>
        <p class="subtitle">ç”¨äºè¯Šæ–­å’Œä¿®å¤Webç«¯è¡¨å•è¾“å…¥é—®é¢˜çš„ç»¼åˆè°ƒè¯•å·¥å…·</p>
        
        <!-- åŸºç¡€è¾“å…¥æµ‹è¯• -->
        <div class="debug-section">
            <h2>1ï¸âƒ£ æ ‡å‡†HTMLè¾“å…¥æµ‹è¯•</h2>
            <div class="form-group">
                <label for="html-text">æ–‡æœ¬è¾“å…¥æ¡†</label>
                <input type="text" id="html-text" class="test-input" placeholder="è¯·è¾“å…¥æ–‡æœ¬æµ‹è¯•..." />
            </div>
            
            <div class="form-group">
                <label for="html-email">é‚®ç®±è¾“å…¥æ¡†</label>
                <input type="email" id="html-email" class="test-input" placeholder="test@example.com" />
            </div>
            
            <div class="form-group">
                <label for="html-password">å¯†ç è¾“å…¥æ¡†</label>
                <input type="password" id="html-password" class="test-input" placeholder="å¯†ç ..." />
            </div>
        </div>
        
        <!-- React Native Web æ ·å¼æµ‹è¯• -->
        <div class="debug-section">
            <h2>2ï¸âƒ£ React Native Web æ ·å¼æ¨¡æ‹Ÿæµ‹è¯•</h2>
            <div class="form-group">
                <label for="rn-text">æ¨¡æ‹ŸRN TextInputæ ·å¼</label>
                <input type="text" id="rn-text" class="rn-web-input" 
                       style="cursor: text; user-select: text; -webkit-user-select: text; pointer-events: auto; -webkit-appearance: none; -moz-appearance: textfield; z-index: 10; position: relative;"
                       placeholder="RN Webæ ·å¼æµ‹è¯•..." />
            </div>
        </div>
        
        <!-- äº¤äº’æµ‹è¯• -->
        <div class="debug-section">
            <h2>3ï¸âƒ£ äº¤äº’äº‹ä»¶æµ‹è¯•</h2>
            <div class="form-group">
                <label for="event-test">äº‹ä»¶ç›‘å¬æµ‹è¯•</label>
                <input type="text" id="event-test" class="test-input" placeholder="è¾“å…¥å†…å®¹æŸ¥çœ‹äº‹ä»¶..." />
            </div>
            <div id="event-log" class="debug-log">ç­‰å¾…ç”¨æˆ·äº¤äº’...</div>
        </div>
        
        <!-- è°ƒè¯•å·¥å…· -->
        <div class="debug-section">
            <h2>4ï¸âƒ£ è°ƒè¯•å·¥å…·</h2>
            <button class="button" onclick="openPomeloXInNewTab()">ğŸš€ æ‰“å¼€PomeloXåº”ç”¨</button>
            <button class="button" onclick="testInputFocus()">ğŸ¯ æµ‹è¯•è¾“å…¥æ¡†èšç„¦</button>
            <button class="button" onclick="simulateUserInput()">ğŸ“ æ¨¡æ‹Ÿç”¨æˆ·è¾“å…¥</button>
            <button class="button" onclick="checkInputStyles()">ğŸ’… æ£€æŸ¥è¾“å…¥æ¡†æ ·å¼</button>
            <button class="button danger" onclick="clearLogs()">ğŸ§¹ æ¸…ç©ºæ—¥å¿—</button>
            
            <div class="test-results">
                <h3>ğŸ“Š æµ‹è¯•ç»“æœ</h3>
                <div id="test-results">æš‚æ— æµ‹è¯•ç»“æœ</div>
            </div>
        </div>
        
        <!-- æµè§ˆå™¨ä¿¡æ¯ -->
        <div class="debug-section">
            <h2>5ï¸âƒ£ æµè§ˆå™¨ç¯å¢ƒä¿¡æ¯</h2>
            <div id="browser-info"></div>
        </div>
    </div>
    
    <script>
        // å…¨å±€è°ƒè¯•å¯¹è±¡
        window.PomeloXDebug = {
            logs: [],
            inputTests: {},
            
            log(message, type = 'info') {
                const timestamp = new Date().toLocaleTimeString();
                const logEntry = `[${timestamp}] [${type.toUpperCase()}] ${message}`;
                this.logs.push(logEntry);
                console.log(logEntry);
                
                // æ›´æ–°äº‹ä»¶æ—¥å¿—æ˜¾ç¤º
                const eventLog = document.getElementById('event-log');
                if (eventLog) {
                    eventLog.textContent = this.logs.slice(-10).join('\n');
                    eventLog.scrollTop = eventLog.scrollHeight;
                }
            }
        };
        
        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            initializeDebugTools();
            setupEventListeners();
            displayBrowserInfo();
            PomeloXDebug.log('è°ƒè¯•å·¥å…·åˆå§‹åŒ–å®Œæˆ', 'success');
        });
        
        function initializeDebugTools() {
            PomeloXDebug.log('å¼€å§‹åˆå§‹åŒ–è°ƒè¯•å·¥å…·...');
            
            // æ£€æµ‹è¾“å…¥æ¡†æ˜¯å¦å¯ç”¨
            const inputs = document.querySelectorAll('input');
            inputs.forEach((input, index) => {
                input.addEventListener('focus', () => {
                    PomeloXDebug.log(`è¾“å…¥æ¡† ${index + 1} è·å¾—ç„¦ç‚¹: ${input.id || input.className}`, 'success');
                });
                
                input.addEventListener('blur', () => {
                    PomeloXDebug.log(`è¾“å…¥æ¡† ${index + 1} å¤±å»ç„¦ç‚¹: ${input.id || input.className}`, 'info');
                });
                
                input.addEventListener('input', (e) => {
                    PomeloXDebug.log(`è¾“å…¥æ¡† ${index + 1} å†…å®¹å˜åŒ–: "${e.target.value}"`, 'info');
                });
            });
        }
        
        function setupEventListeners() {
            const eventTestInput = document.getElementById('event-test');
            
            // ç›‘å¬æ‰€æœ‰å¯èƒ½çš„è¾“å…¥äº‹ä»¶
            const events = ['focus', 'blur', 'input', 'change', 'keydown', 'keyup', 'click', 'mousedown', 'mouseup', 'touchstart', 'touchend'];
            
            events.forEach(eventName => {
                eventTestInput.addEventListener(eventName, function(e) {
                    PomeloXDebug.log(`äº‹ä»¶è§¦å‘: ${eventName} - å€¼: "${e.target.value}"`, 'info');
                });
            });
        }
        
        function openPomeloXInNewTab() {
            PomeloXDebug.log('æ­£åœ¨æ‰“å¼€PomeloXåº”ç”¨...', 'info');
            window.open('http://localhost:8090', '_blank');
        }
        
        function testInputFocus() {
            PomeloXDebug.log('å¼€å§‹æµ‹è¯•è¾“å…¥æ¡†èšç„¦åŠŸèƒ½...', 'info');
            
            const inputs = document.querySelectorAll('input');
            let testIndex = 0;
            
            function focusNext() {
                if (testIndex < inputs.length) {
                    const input = inputs[testIndex];
                    PomeloXDebug.log(`èšç„¦æµ‹è¯• ${testIndex + 1}/${inputs.length}: ${input.id || input.className}`, 'info');
                    
                    input.focus();
                    setTimeout(() => {
                        const isFocused = document.activeElement === input;
                        PomeloXDebug.log(`èšç„¦ç»“æœ: ${isFocused ? 'æˆåŠŸ' : 'å¤±è´¥'}`, isFocused ? 'success' : 'error');
                        testIndex++;
                        focusNext();
                    }, 1000);
                } else {
                    PomeloXDebug.log('è¾“å…¥æ¡†èšç„¦æµ‹è¯•å®Œæˆ', 'success');
                }
            }
            
            focusNext();
        }
        
        function simulateUserInput() {
            PomeloXDebug.log('å¼€å§‹æ¨¡æ‹Ÿç”¨æˆ·è¾“å…¥...', 'info');
            
            const testInput = document.getElementById('event-test');
            const testValue = 'æ¨¡æ‹Ÿè¾“å…¥æµ‹è¯•' + Math.random().toString(36).substring(7);
            
            // èšç„¦è¾“å…¥æ¡†
            testInput.focus();
            
            setTimeout(() => {
                // æ¸…ç©ºè¾“å…¥æ¡†
                testInput.value = '';
                testInput.dispatchEvent(new Event('input', { bubbles: true }));
                
                // é€å­—ç¬¦è¾“å…¥
                let charIndex = 0;
                const typeChar = () => {
                    if (charIndex < testValue.length) {
                        testInput.value += testValue[charIndex];
                        testInput.dispatchEvent(new Event('input', { bubbles: true }));
                        charIndex++;
                        setTimeout(typeChar, 100);
                    } else {
                        PomeloXDebug.log(`æ¨¡æ‹Ÿè¾“å…¥å®Œæˆ: "${testValue}"`, 'success');
                        testInput.dispatchEvent(new Event('change', { bubbles: true }));
                    }
                };
                typeChar();
            }, 500);
        }
        
        function checkInputStyles() {
            PomeloXDebug.log('å¼€å§‹æ£€æŸ¥è¾“å…¥æ¡†æ ·å¼...', 'info');
            
            const inputs = document.querySelectorAll('input');
            inputs.forEach((input, index) => {
                const styles = window.getComputedStyle(input);
                const importantStyles = {
                    cursor: styles.cursor,
                    userSelect: styles.userSelect,
                    pointerEvents: styles.pointerEvents,
                    zIndex: styles.zIndex,
                    position: styles.position,
                    opacity: styles.opacity,
                    visibility: styles.visibility,
                    display: styles.display
                };
                
                PomeloXDebug.log(`è¾“å…¥æ¡† ${index + 1} æ ·å¼: ${JSON.stringify(importantStyles)}`, 'info');
            });
            
            updateTestResults();
        }
        
        function updateTestResults() {
            const resultsDiv = document.getElementById('test-results');
            const inputs = document.querySelectorAll('input');
            let results = '';
            
            inputs.forEach((input, index) => {
                const canFocus = input.tabIndex !== -1 && input.style.pointerEvents !== 'none';
                const statusClass = canFocus ? 'status-success' : 'status-error';
                const statusText = canFocus ? 'æ­£å¸¸' : 'å¼‚å¸¸';
                
                results += `<div><span class="status-indicator ${statusClass}"></span>è¾“å…¥æ¡† ${index + 1}: ${statusText}</div>`;
            });
            
            resultsDiv.innerHTML = results;
        }
        
        function clearLogs() {
            PomeloXDebug.logs = [];
            document.getElementById('event-log').textContent = 'æ—¥å¿—å·²æ¸…ç©º...';
            document.getElementById('test-results').textContent = 'æš‚æ— æµ‹è¯•ç»“æœ';
            PomeloXDebug.log('æ—¥å¿—å·²æ¸…ç©º', 'info');
        }
        
        function displayBrowserInfo() {
            const info = {
                userAgent: navigator.userAgent,
                platform: navigator.platform,
                language: navigator.language,
                cookieEnabled: navigator.cookieEnabled,
                onLine: navigator.onLine,
                viewport: `${window.innerWidth}x${window.innerHeight}`,
                screen: `${screen.width}x${screen.height}`,
                devicePixelRatio: window.devicePixelRatio,
                touchSupport: 'ontouchstart' in window,
                localStorage: typeof(Storage) !== 'undefined',
                webGL: !!window.WebGLRenderingContext
            };
            
            let infoHtml = '';
            Object.entries(info).forEach(([key, value]) => {
                infoHtml += `<div><strong>${key}:</strong> ${value}</div>`;
            });
            
            document.getElementById('browser-info').innerHTML = infoHtml;
        }
        
        // ç›‘å¬æ¥è‡ªPomeloXåº”ç”¨çš„æ¶ˆæ¯
        window.addEventListener('message', function(event) {
            if (event.origin === 'http://localhost:8090') {
                PomeloXDebug.log(`æ”¶åˆ°æ¥è‡ªPomeloXçš„æ¶ˆæ¯: ${JSON.stringify(event.data)}`, 'info');
            }
        });
        
        // å…¨å±€é”™è¯¯å¤„ç†
        window.addEventListener('error', function(e) {
            PomeloXDebug.log(`JavaScripté”™è¯¯: ${e.message} (${e.filename}:${e.lineno})`, 'error');
        });
        
        // ç›‘å¬é¡µé¢å¯è§æ€§å˜åŒ–
        document.addEventListener('visibilitychange', function() {
            PomeloXDebug.log(`é¡µé¢å¯è§æ€§: ${document.visibilityState}`, 'info');
        });
    </script>
</body>
</html>