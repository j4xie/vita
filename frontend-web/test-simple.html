<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PomeloX 测试页面</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      margin: 0;
      padding: 40px;
      min-height: 100vh;
    }
    
    .container {
      max-width: 800px;
      margin: 0 auto;
      background: rgba(255,255,255,0.1);
      padding: 40px;
      border-radius: 20px;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255,255,255,0.2);
    }
    
    h1 {
      text-align: center;
      font-size: 3rem;
      margin-bottom: 30px;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
    }
    
    .features {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
      margin: 40px 0;
    }
    
    .feature-card {
      background: rgba(255,255,255,0.15);
      padding: 25px;
      border-radius: 15px;
      border: 1px solid rgba(255,255,255,0.2);
      transition: transform 0.3s ease;
    }
    
    .feature-card:hover {
      transform: translateY(-5px);
    }
    
    .feature-card h3 {
      font-size: 1.5rem;
      margin-bottom: 15px;
    }
    
    .btn {
      background: rgba(255,255,255,0.2);
      color: white;
      border: 2px solid rgba(255,255,255,0.3);
      padding: 15px 30px;
      border-radius: 25px;
      cursor: pointer;
      font-size: 1rem;
      margin: 10px;
      transition: all 0.3s ease;
      text-decoration: none;
      display: inline-block;
    }
    
    .btn:hover {
      background: rgba(255,255,255,0.3);
      border-color: rgba(255,255,255,0.5);
      transform: translateY(-2px);
    }
    
    .activity-list {
      margin-top: 30px;
    }
    
    .activity-card {
      background: rgba(255,255,255,0.1);
      padding: 20px;
      margin: 15px 0;
      border-radius: 15px;
      border-left: 4px solid #4CAF50;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .activity-card:hover {
      background: rgba(255,255,255,0.15);
      transform: translateX(10px);
    }
    
    .search-box {
      width: 100%;
      padding: 15px;
      border: 2px solid rgba(255,255,255,0.3);
      border-radius: 25px;
      background: rgba(255,255,255,0.1);
      color: white;
      font-size: 1rem;
      margin-bottom: 20px;
    }
    
    .search-box::placeholder {
      color: rgba(255,255,255,0.7);
    }
    
    .log {
      background: rgba(0,0,0,0.2);
      padding: 15px;
      border-radius: 10px;
      margin: 20px 0;
      font-family: monospace;
      font-size: 0.9rem;
      max-height: 200px;
      overflow-y: auto;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>🎭 PomeloX 测试页面</h1>
    
    <p style="text-align: center; font-size: 1.2rem; opacity: 0.9;">
      这是一个用于测试 Playwright 监控系统的简单页面
    </p>
    
    <div class="features">
      <div class="feature-card">
        <h3>🎯 活动管理</h3>
        <p>浏览和报名各种校园活动，结识新朋友，丰富校园生活。</p>
        <button class="btn" onclick="loadActivities()">查看活动</button>
      </div>
      
      <div class="feature-card">
        <h3>👥 用户系统</h3>
        <p>完善的用户认证和权限管理，保障数据安全。</p>
        <button class="btn" onclick="showLogin()">登录系统</button>
      </div>
      
      <div class="feature-card">
        <h3>🔍 搜索功能</h3>
        <p>快速搜索活动、用户和相关信息。</p>
        <input type="text" class="search-box" placeholder="搜索活动..." onkeyup="handleSearch(this.value)">
      </div>
      
      <div class="feature-card">
        <h3>📊 数据统计</h3>
        <p>实时监控应用性能和用户行为数据。</p>
        <button class="btn" onclick="generateTestError()">测试错误处理</button>
      </div>
    </div>
    
    <div class="activity-list" id="activity-list" style="display: none;">
      <h2>📅 活动列表</h2>
      <div class="activity-card" onclick="viewActivity('spring-party')">
        <h4>🎉 CU 2025 春季迎新派对</h4>
        <p>时间: 2025年9月15日 18:00 | 地点: 学生活动中心</p>
      </div>
      <div class="activity-card" onclick="viewActivity('chinese-new-year')">
        <h4>🧧 中国新年庆祝晚会</h4>
        <p>时间: 2025年2月10日 19:00 | 地点: 大礼堂</p>
      </div>
      <div class="activity-card" onclick="viewActivity('career-workshop')">
        <h4>💼 职业发展工作坊</h4>
        <p>时间: 2025年9月20日 14:00 | 地点: 图书馆会议室</p>
      </div>
    </div>
    
    <div id="console-log" class="log" style="display: none;">
      <h3>🖥️ 控制台日志</h3>
      <div id="log-content">
        <div>2025-09-06 16:30:00 - 页面已加载</div>
      </div>
    </div>
  </div>

  <script>
    // 模拟应用功能的JavaScript代码
    
    let logVisible = false;
    let activities = [];
    
    // 日志函数
    function log(message) {
      const timestamp = new Date().toLocaleString();
      const logContent = document.getElementById('log-content');
      const entry = document.createElement('div');
      entry.textContent = `${timestamp} - ${message}`;
      logContent.appendChild(entry);
      
      // 同时输出到控制台供Playwright监控
      console.log(`[PomeloX] ${message}`);
    }
    
    // 加载活动列表
    function loadActivities() {
      log('开始加载活动列表...');
      
      const activityList = document.getElementById('activity-list');
      activityList.style.display = 'block';
      
      // 模拟API调用
      setTimeout(() => {
        log('活动列表加载完成');
        activities = [
          { id: 'spring-party', name: 'CU 2025 春季迎新派对', participants: 0 },
          { id: 'chinese-new-year', name: '中国新年庆祝晚会', participants: 0 },
          { id: 'career-workshop', name: '职业发展工作坊', participants: 0 }
        ];
      }, 1000);
    }
    
    // 显示登录界面
    function showLogin() {
      log('显示登录界面');
      
      const username = prompt('请输入用户名:');
      if (username) {
        log(`用户 ${username} 尝试登录`);
        
        // 模拟登录验证
        setTimeout(() => {
          if (username === 'admin') {
            log('登录成功 - 管理员权限');
            alert('登录成功！欢迎管理员');
          } else {
            log('登录成功 - 普通用户权限');
            alert(`登录成功！欢迎 ${username}`);
          }
        }, 800);
      }
    }
    
    // 处理搜索
    function handleSearch(query) {
      if (query.length > 0) {
        log(`搜索关键词: "${query}"`);
        
        // 模拟搜索延迟
        setTimeout(() => {
          const results = activities.filter(activity => 
            activity.name.toLowerCase().includes(query.toLowerCase())
          );
          log(`搜索完成，找到 ${results.length} 个结果`);
        }, 300);
      }
    }
    
    // 查看活动详情
    function viewActivity(activityId) {
      log(`查看活动详情: ${activityId}`);
      
      const activity = activities.find(a => a.id === activityId);
      if (activity) {
        activity.participants++;
        log(`活动 "${activity.name}" 查看次数: ${activity.participants}`);
        alert(`活动详情:\n${activity.name}\n查看次数: ${activity.participants}`);
      }
    }
    
    // 生成测试错误
    function generateTestError() {
      log('生成测试错误...');
      
      // 随机生成不同类型的错误
      const errorTypes = [
        () => {
          // JavaScript 错误
          throw new Error('这是一个测试用的JavaScript错误');
        },
        () => {
          // 尝试访问不存在的元素
          document.getElementById('non-existent-element').click();
        },
        () => {
          // 网络请求错误（模拟）
          fetch('/non-existent-api')
            .then(response => {
              if (!response.ok) {
                throw new Error(`HTTP ${response.status}: ${response.statusText}`);
              }
            })
            .catch(error => {
              console.error('网络请求失败:', error.message);
            });
        },
        () => {
          // 控制台警告
          console.warn('这是一个测试警告信息');
        }
      ];
      
      const randomError = errorTypes[Math.floor(Math.random() * errorTypes.length)];
      
      try {
        randomError();
      } catch (error) {
        console.error('捕获的错误:', error.message);
        log(`错误已生成: ${error.message}`);
      }
    }
    
    // 切换日志显示
    function toggleLog() {
      const logDiv = document.getElementById('console-log');
      logVisible = !logVisible;
      logDiv.style.display = logVisible ? 'block' : 'none';
      log(logVisible ? '控制台日志已显示' : '控制台日志已隐藏');
    }
    
    // 性能监控
    function measurePerformance() {
      const startTime = performance.now();
      
      // 模拟一些计算
      let result = 0;
      for (let i = 0; i < 1000000; i++) {
        result += Math.random();
      }
      
      const endTime = performance.now();
      const duration = endTime - startTime;
      
      log(`性能测试完成，耗时: ${duration.toFixed(2)}ms`);
    }
    
    // 页面加载完成事件
    window.addEventListener('load', function() {
      log('页面加载完成');
      
      // 添加一些交互按钮
      const container = document.querySelector('.container');
      const buttonsDiv = document.createElement('div');
      buttonsDiv.style.textAlign = 'center';
      buttonsDiv.style.marginTop = '30px';
      
      buttonsDiv.innerHTML = `
        <button class="btn" onclick="toggleLog()">显示/隐藏日志</button>
        <button class="btn" onclick="measurePerformance()">性能测试</button>
        <button class="btn" onclick="location.reload()">刷新页面</button>
      `;
      
      container.appendChild(buttonsDiv);
    });
    
    // 定期更新
    setInterval(() => {
      const now = new Date().toLocaleTimeString();
      console.info(`[PomeloX] 系统状态正常 - ${now}`);
    }, 10000);
    
    // 页面可见性变化监听
    document.addEventListener('visibilitychange', function() {
      if (document.hidden) {
        log('页面已隐藏');
      } else {
        log('页面已显示');
      }
    });
    
    // 错误全局捕获
    window.addEventListener('error', function(event) {
      log(`全局错误捕获: ${event.message} (${event.filename}:${event.lineno})`);
    });
    
    // Promise 错误捕获
    window.addEventListener('unhandledrejection', function(event) {
      log(`未处理的Promise错误: ${event.reason}`);
      event.preventDefault();
    });
    
    console.log('🎭 PomeloX 测试页面已初始化');
  </script>
</body>
</html>