# PomeloX ç½‘é¡µç«¯å®æ—¶ç›‘æ§æ–¹æ¡ˆ

![PomeloX Logo](https://img.shields.io/badge/PomeloX-ç›‘æ§ç³»ç»Ÿ-orange) ![Playwright](https://img.shields.io/badge/Playwright-Latest-green) ![TypeScript](https://img.shields.io/badge/TypeScript-5.8+-blue)

è¿™æ˜¯ä¸€ä¸ªåŸºäº **Playwright** çš„å®Œæ•´ç½‘é¡µç«¯å®æ—¶ç›‘æ§è§£å†³æ–¹æ¡ˆï¼Œä¸“é—¨ä¸º PomeloX åº”ç”¨è®¾è®¡ï¼Œæä¾›æ§åˆ¶å°ç›‘æ§ã€é”™è¯¯è¿½è¸ªã€æ€§èƒ½åˆ†æå’Œè‡ªåŠ¨åŒ–æµ‹è¯•åŠŸèƒ½ã€‚

## ğŸš€ åŠŸèƒ½ç‰¹æ€§

### ğŸ“Š å®æ—¶ç›‘æ§
- **æ§åˆ¶å°ç›‘æ§**: æ•è·æ‰€æœ‰ console.logã€warnã€error æ¶ˆæ¯
- **é”™è¯¯è¿½è¸ª**: JavaScripté”™è¯¯ã€ç½‘ç»œé”™è¯¯ã€CORSé”™è¯¯ç­‰å…¨é¢è¿½è¸ª
- **æ€§èƒ½ç›‘æ§**: Web Vitalsã€å†…å­˜ä½¿ç”¨ã€ç½‘ç»œè¯·æ±‚æ€§èƒ½åˆ†æ
- **ç”¨æˆ·äº¤äº’ç›‘æ§**: ç‚¹å‡»ã€è¾“å…¥ã€å¯¼èˆªç­‰ç”¨æˆ·è¡Œä¸ºè¿½è¸ª

### ğŸ› ï¸ è‡ªåŠ¨åŒ–æµ‹è¯•
- **ç«¯åˆ°ç«¯æµ‹è¯•**: æ´»åŠ¨æµç¨‹ã€ç”¨æˆ·è®¤è¯å®Œæ•´æµ‹è¯•
- **å¤šæµè§ˆå™¨æ”¯æŒ**: Chromeã€Firefoxã€Safari å…¼å®¹æ€§æµ‹è¯•
- **ç§»åŠ¨ç«¯æµ‹è¯•**: å“åº”å¼è®¾è®¡å’Œç§»åŠ¨ç«¯ä½“éªŒæµ‹è¯•
- **APIé›†æˆæµ‹è¯•**: åç«¯æ¥å£è°ƒç”¨éªŒè¯

### ğŸ­ å¯è§†åŒ–é¢æ¿
- **å®æ—¶ç›‘æ§é¢æ¿**: ç¾è§‚çš„å®æ—¶æ•°æ®å¯è§†åŒ–ç•Œé¢
- **æ€§èƒ½æŒ‡æ ‡**: åŠ è½½æ—¶é—´ã€å†…å­˜ä½¿ç”¨ã€é”™è¯¯ç»Ÿè®¡
- **æ—¥å¿—æŸ¥çœ‹å™¨**: å®æ—¶æ—¥å¿—æµå’Œå†å²è®°å½•
- **æµ‹è¯•ç»“æœ**: è‡ªåŠ¨åŒ–æµ‹è¯•æ‰§è¡Œç»“æœå’ŒæŠ¥å‘Š

## ğŸ“ é¡¹ç›®ç»“æ„

```
frontend-web/
â”œâ”€â”€ playwright.config.ts          # Playwright é…ç½®
â”œâ”€â”€ monitor-dashboard.html         # ç›‘æ§é¢æ¿ç•Œé¢
â”œâ”€â”€ test-simple.html              # æµ‹è¯•ç”¨é¡µé¢
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ global-setup.ts           # å…¨å±€è®¾ç½®
â”‚   â”œâ”€â”€ global-teardown.ts        # å…¨å±€æ¸…ç†
â”‚   â”œâ”€â”€ monitoring/               # ç›‘æ§æµ‹è¯•å¥—ä»¶
â”‚   â”‚   â”œâ”€â”€ console-monitor.spec.ts    # æ§åˆ¶å°ç›‘æ§
â”‚   â”‚   â”œâ”€â”€ error-tracker.spec.ts      # é”™è¯¯è¿½è¸ª
â”‚   â”‚   â””â”€â”€ performance-monitor.spec.ts # æ€§èƒ½ç›‘æ§
â”‚   â”œâ”€â”€ e2e/                     # ç«¯åˆ°ç«¯æµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ activity-flow.spec.ts      # æ´»åŠ¨æµç¨‹æµ‹è¯•
â”‚   â”‚   â””â”€â”€ auth-flow.spec.ts          # è®¤è¯æµç¨‹æµ‹è¯•
â”‚   â””â”€â”€ utils/                   # æµ‹è¯•å·¥å…·
â”‚       â””â”€â”€ test-helpers.ts            # æµ‹è¯•è¾…åŠ©å‡½æ•°
â”œâ”€â”€ monitoring-logs/             # ç›‘æ§æ—¥å¿—å­˜å‚¨
â”œâ”€â”€ performance-data/            # æ€§èƒ½æ•°æ®å­˜å‚¨
â”œâ”€â”€ screenshots/                 # é”™è¯¯æˆªå›¾
â””â”€â”€ test-results/               # æµ‹è¯•ç»“æœè¾“å‡º
```

## ğŸ¯ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- Node.js 18+
- npm æˆ– yarn

### å®‰è£…ä¾èµ–
```bash
cd frontend-web
npm install
```

### è¿è¡Œç›‘æ§æµ‹è¯•
```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
npm test

# è¿è¡Œç‰¹å®šç›‘æ§æµ‹è¯•
npm run test:console     # æ§åˆ¶å°ç›‘æ§
npm run test:errors      # é”™è¯¯è¿½è¸ª
npm run test:performance # æ€§èƒ½ç›‘æ§

# è¿è¡Œç«¯åˆ°ç«¯æµ‹è¯•
npm run test:activities  # æ´»åŠ¨æµç¨‹æµ‹è¯•
npm run test:auth       # è®¤è¯æµç¨‹æµ‹è¯•
```

### å¯åŠ¨ç›‘æ§é¢æ¿
```bash
# è¿è¡Œç›‘æ§å¹¶æ‰“å¼€é¢æ¿
npm run monitor:start

# ä»…æ‰“å¼€ç›‘æ§é¢æ¿
npm run monitor:dashboard
```

## ğŸ“Š ç›‘æ§åŠŸèƒ½è¯¦è§£

### 1. æ§åˆ¶å°ç›‘æ§ (Console Monitor)

å®æ—¶æ•è·å’Œåˆ†ææµè§ˆå™¨æ§åˆ¶å°è¾“å‡ºï¼š

**åŠŸèƒ½ç‰¹æ€§:**
- âœ… å®æ—¶æ—¥å¿—æ•è· (log, info, warn, error)
- âœ… é”™è¯¯å †æ ˆè¿½è¸ª
- âœ… ç½‘ç»œè¯·æ±‚å¤±è´¥ç›‘æ§
- âœ… æœªå¤„ç†Promiseé”™è¯¯æ•è·
- âœ… ç»Ÿè®¡æŠ¥å‘Šç”Ÿæˆ

**ä½¿ç”¨ç¤ºä¾‹:**
```bash
npm run test:console
```

### 2. é”™è¯¯è¿½è¸ª (Error Tracker)

ä¸“ä¸šçš„é”™è¯¯è¿½è¸ªå’Œåˆ†æç³»ç»Ÿï¼š

**é”™è¯¯ç±»å‹è¦†ç›–:**
- ğŸ› JavaScript è¿è¡Œæ—¶é”™è¯¯
- ğŸŒ ç½‘ç»œè¯·æ±‚é”™è¯¯ (404, 500, è¶…æ—¶ç­‰)
- ğŸ”’ å®‰å…¨é”™è¯¯ (CORS, CSPç­‰)
- âš¡ æœªå¤„ç†çš„Promiseæ‹’ç»
- ğŸ“¦ èµ„æºåŠ è½½å¤±è´¥

**è‡ªåŠ¨åŠŸèƒ½:**
- é”™è¯¯ä¸¥é‡ç¨‹åº¦åˆ†ç±» (Critical, High, Medium, Low)
- è‡ªåŠ¨æˆªå›¾ä¿å­˜ (ä¸¥é‡é”™è¯¯)
- é”™è¯¯ä¸Šä¸‹æ–‡ä¿¡æ¯æ”¶é›†
- è¯¦ç»†æŠ¥å‘Šç”Ÿæˆ

### 3. æ€§èƒ½ç›‘æ§ (Performance Monitor)

å…¨é¢çš„Webæ€§èƒ½åˆ†æå·¥å…·ï¼š

**ç›‘æ§æŒ‡æ ‡:**
- âš¡ Web Vitals (FCP, LCP, CLS, FID)
- ğŸ§  å†…å­˜ä½¿ç”¨ç›‘æ§
- ğŸŒ ç½‘ç»œè¯·æ±‚åˆ†æ
- ğŸ“Š æ€§èƒ½è¯„åˆ†ç³»ç»Ÿ
- ğŸ“ˆ æ€§èƒ½è¶‹åŠ¿åˆ†æ

**ä¼˜åŒ–å»ºè®®:**
- è‡ªåŠ¨æ€§èƒ½å®¡è®¡
- å¤§å‹èµ„æºæ£€æµ‹
- é‡å¤è¯·æ±‚è¯†åˆ«
- æœªä½¿ç”¨ä»£ç åˆ†æ
- Critical Resource Hints æ£€æŸ¥

### 4. ç«¯åˆ°ç«¯æµ‹è¯• (E2E Testing)

å®Œæ•´çš„ç”¨æˆ·æµç¨‹æµ‹è¯•ï¼š

**æµ‹è¯•è¦†ç›–:**
- ğŸ“± æ´»åŠ¨æµè§ˆå’ŒæŠ¥åæµç¨‹
- ğŸ” ç”¨æˆ·ç™»å½•æ³¨å†Œæµç¨‹
- ğŸ” æœç´¢å’Œç­›é€‰åŠŸèƒ½
- ğŸ“± å“åº”å¼è®¾è®¡æµ‹è¯•
- â™¿ æ— éšœç¢åŠŸèƒ½æµ‹è¯•

## ğŸ­ ç›‘æ§é¢æ¿ä½¿ç”¨æŒ‡å—

### é¢æ¿åŠŸèƒ½
1. **å®æ—¶çŠ¶æ€**: å½“å‰ç›‘æ§çŠ¶æ€å’Œä¼šè¯ä¿¡æ¯
2. **æ€§èƒ½æŒ‡æ ‡**: é¡µé¢åŠ è½½æ—¶é—´ã€FCPã€LCPç­‰
3. **é”™è¯¯ç»Ÿè®¡**: JavaScripté”™è¯¯ã€ç½‘ç»œé”™è¯¯ç»Ÿè®¡
4. **ç½‘ç»œæ´»åŠ¨**: è¯·æ±‚æ•°é‡ã€å“åº”æ—¶é—´ã€ä¼ è¾“é‡
5. **ç”¨æˆ·ä½“éªŒ**: äº¤äº’å“åº”æ—¶é—´ã€ç¨³å®šæ€§è¯„åˆ†
6. **æµ‹è¯•ç»“æœ**: è‡ªåŠ¨åŒ–æµ‹è¯•é€šè¿‡ç‡å’Œè¦†ç›–ç‡

### æ“ä½œæŒ‰é’®
- ğŸš€ **å¼€å§‹ç›‘æ§**: å¯åŠ¨å®æ—¶ç›‘æ§
- â¸ï¸ **æš‚åœç›‘æ§**: æš‚åœæ•°æ®æ”¶é›†
- ğŸ—‘ï¸ **æ¸…é™¤æ—¥å¿—**: æ¸…ç†å†å²æ—¥å¿—
- ğŸ“Š **å¯¼å‡ºæ•°æ®**: å¯¼å‡ºç›‘æ§æ•°æ®ä¸ºJSON
- ğŸ§ª **è¿è¡Œæµ‹è¯•**: æ‰§è¡Œè‡ªåŠ¨åŒ–æµ‹è¯•å¥—ä»¶

### å®æ—¶æ—¥å¿—
- ğŸ”´ é”™è¯¯ä¿¡æ¯ (çº¢è‰²èƒŒæ™¯)
- ğŸŸ¡ è­¦å‘Šä¿¡æ¯ (æ©™è‰²èƒŒæ™¯)
- ğŸ”µ æ™®é€šä¿¡æ¯ (è“è‰²èƒŒæ™¯)
- ğŸŸ¢ æˆåŠŸä¿¡æ¯ (ç»¿è‰²èƒŒæ™¯)

## ğŸ”§ é«˜çº§é…ç½®

### Playwright é…ç½® (playwright.config.ts)

```typescript
export default defineConfig({
  // æµ‹è¯•è¶…æ—¶
  timeout: 30 * 1000,
  
  // å¤±è´¥é‡è¯•
  retries: 2,
  
  // æµè§ˆå™¨é…ç½®
  use: {
    headless: false,  // æ˜¾ç¤ºæµè§ˆå™¨çª—å£
    screenshot: 'only-on-failure',
    video: 'retain-on-failure',
    trace: 'on-first-retry',
  },
  
  // å¤šé¡¹ç›®æ”¯æŒ
  projects: [
    { name: 'chromium-desktop' },
    { name: 'firefox-desktop' },
    { name: 'webkit-desktop' },
    { name: 'mobile-chrome' },
    { name: 'mobile-safari' },
    { name: 'monitor-mode' },  // ä¸“ç”¨ç›‘æ§æ¨¡å¼
  ],
});
```

### è‡ªå®šä¹‰ç›‘æ§å™¨

åˆ›å»ºè‡ªå®šä¹‰ç›‘æ§å™¨ï¼š

```typescript
import { ConsoleMonitor } from './tests/monitoring/console-monitor.spec.ts';

const monitor = new ConsoleMonitor();
await monitor.startMonitoring(page);

// è·å–ç»Ÿè®¡ä¿¡æ¯
const stats = monitor.getStats();
console.log(`é”™è¯¯æ•°: ${stats.errorCount}`);

// è·å–é”™è¯¯åˆ—è¡¨
const errors = monitor.getErrors();
errors.forEach(error => {
  console.log(`é”™è¯¯: ${error.text}`);
});
```

## ğŸ” Browser Tools é›†æˆæ½œåŠ›

è€ƒè™‘åˆ°ä½ æåˆ°çš„ **Browser Tools**ï¼Œè¿™ä¸ªç›‘æ§æ–¹æ¡ˆä¹Ÿå¯ä»¥å¾ˆå®¹æ˜“åœ°é›†æˆå…¶ä»–æµè§ˆå™¨è‡ªåŠ¨åŒ–å·¥å…·ï¼š

### å¯é›†æˆå·¥å…·:
- **Puppeteer**: æ›´åº•å±‚çš„Chrome DevToolsåè®®æ§åˆ¶
- **Selenium**: è·¨æµè§ˆå™¨WebDriveræ”¯æŒ
- **Cypress**: å¼€å‘è€…å‹å¥½çš„æµ‹è¯•å·¥å…·
- **WebDriver.IO**: åŠŸèƒ½ä¸°å¯Œçš„è‡ªåŠ¨åŒ–æ¡†æ¶

### Browser Tools ä¼˜åŠ¿:
- ğŸ› ï¸ ç›´æ¥è®¿é—® Chrome DevTools API
- ğŸ“± ç§»åŠ¨ç«¯è°ƒè¯•æ”¯æŒ
- ğŸ” æ›´ç»†ç²’åº¦çš„ç½‘ç»œæ§åˆ¶
- ğŸ“Š åŸç”Ÿæ€§èƒ½åˆ†æå·¥å…·

## ğŸ“ˆ æŠ¥å‘Šå’Œåˆ†æ

### è‡ªåŠ¨ç”ŸæˆæŠ¥å‘Š
```bash
# ç”ŸæˆHTMLæŠ¥å‘Š
npx playwright show-report

# ç”ŸæˆJSONæ•°æ®
npm run test -- --reporter=json
```

### æ•°æ®å¯¼å‡ºæ ¼å¼
```json
{
  "session": {
    "start": "2025-09-06T16:30:00.000Z",
    "duration": "00:05:30",
    "status": "completed"
  },
  "metrics": {
    "performance": {...},
    "errors": [...],
    "requests": [...]
  },
  "summary": {
    "totalErrors": 3,
    "performanceScore": 85,
    "testsPassed": 12,
    "testsFailed": 1
  }
}
```

## ğŸš¨ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **æµè§ˆå™¨å¯åŠ¨å¤±è´¥**
   ```bash
   npx playwright install
   ```

2. **æƒé™é”™è¯¯ (Firefox)**
   - Firefoxä¸æ”¯æŒæŸäº›Chromeç‰¹å®šæƒé™
   - ä½¿ç”¨ `--project=chromium-desktop` é™åˆ¶æµ‹è¯•

3. **æ–‡ä»¶è·¯å¾„é—®é¢˜**
   - ç¡®ä¿ä½¿ç”¨ç»å¯¹è·¯å¾„æˆ–æ­£ç¡®çš„ç›¸å¯¹è·¯å¾„
   - æ£€æŸ¥ `baseURL` é…ç½®

4. **æµ‹è¯•è¶…æ—¶**
   - å¢åŠ  `timeout` é…ç½®
   - ä½¿ç”¨ `--timeout=60000` å‚æ•°

### è°ƒè¯•æ¨¡å¼
```bash
# è°ƒè¯•æ¨¡å¼è¿è¡Œ
npm run test:debug

# æŸ¥çœ‹æµ‹è¯•UI
npm run test:ui

# æ˜¾ç¤ºæµè§ˆå™¨çª—å£
npm run test:headed
```

## ğŸ‰ æ€»ç»“

è¿™ä¸ª PomeloX ç½‘é¡µç«¯ç›‘æ§æ–¹æ¡ˆæä¾›äº†ï¼š

âœ… **å®Œæ•´çš„ç›‘æ§è¦†ç›–**: æ§åˆ¶å°ã€é”™è¯¯ã€æ€§èƒ½ã€ç”¨æˆ·è¡Œä¸º  
âœ… **ä¼ä¸šçº§æµ‹è¯•æ¡†æ¶**: å¤šæµè§ˆå™¨ã€å¤šè®¾å¤‡ã€å¤šåœºæ™¯  
âœ… **ç¾è§‚çš„å¯è§†åŒ–é¢æ¿**: å®æ—¶æ•°æ®å±•ç¤ºå’Œäº¤äº’  
âœ… **çµæ´»çš„æ‰©å±•æ€§**: æ”¯æŒè‡ªå®šä¹‰ç›‘æ§å™¨å’Œæµ‹è¯•  
âœ… **ç”Ÿäº§å°±ç»ª**: ç¨³å®šå¯é çš„ç›‘æ§å’Œæµ‹è¯•è§£å†³æ–¹æ¡ˆ  

è¿™ä¸ªæ–¹æ¡ˆä¸ **Browser Tools** å¯ä»¥å¾ˆå¥½åœ°äº’è¡¥ï¼Œæä¾›æ›´å…¨é¢çš„ç½‘é¡µç«¯ç›‘æ§å’Œæµ‹è¯•èƒ½åŠ›ã€‚

---

**éœ€è¦å¸®åŠ©æˆ–æœ‰é—®é¢˜ï¼Ÿ**  
- ğŸ“§ æŸ¥çœ‹æµ‹è¯•æŠ¥å‘Š: `npx playwright show-report`
- ğŸ”§ é…ç½®å‚è€ƒ: `playwright.config.ts`  
- ğŸ“Š ç›‘æ§é¢æ¿: `monitor-dashboard.html`  
- ğŸ§ª æµ‹è¯•å·¥å…·: `tests/utils/test-helpers.ts`

äº«å—ä½ çš„ PomeloX ç›‘æ§ä½“éªŒï¼ğŸ­âœ¨